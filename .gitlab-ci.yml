before_script:
  - 'dotnet restore'

stages:
  - build
  - test

build:
  stage: build
  script:
    - echo $CI_PROJECT_DIR
    - BuildProject.cmd
  except:
    - tags

lint:
  stage: test
  script:
    - echo "Inspecting code..."
    - 'C:\Users\steve\.dotnet\tools\jb inspectcode "Thesis - Multicut in Trees.sln" -o=".\Resharper\inspectcode.xml"'
    - echo "Running cleanup..."
    - 'C:\Users\steve\.dotnet\tools\jb cleanupcode "Thesis - Multicut in Trees.sln"'
    - echo "Detecting duplicates..."
    - 'C:\Users\steve\.dotnet\tools\jb dupfinder "Thesis - Multicut in Trees.sln" -o=".\Resharper\dupfinder.xml"'
  except:
    - tags

test:
  stage: test
  script:
    - echo testing...
    - 'dotnet test "TESTS - Multicut in Trees" /p:CollectCoverage=true /p:CoverletOutputFormat=cobertura /p:Threshold=90 /p:Exclude="[*]AutoGeneratedProgram"'
  except:
    - tags
