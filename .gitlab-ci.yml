before_script:
  - export PATH=$PATH:C:\Users\steve\.dotnet\tools
  - 'dotnet restore'

stages:
  - build
  - test

build:
  stage: build
  script:
    - echo building...
    - 'dotnet build "Thesis - Multicut in Trees"'
  except:
    - tags

lint:
  stage: test
  script:
    - echo "Inspecting code..."
    - 'jb inspectcode "Thesis - Multicut in Trees.sln" -o=".\Resharper\inspectcode.xml"'
    - echo "Running cleanup..."
    - 'jb cleanupcode "Thesis - Multicut in Trees.sln"'
    - echo "Detecting duplicates..."
    - 'jb dupfinder "Thesis - Multicut in Trees.sln" -o=".\Resharper\dupfinder.xml"'
  except:
    - tags

test:
  stage: test
  script:
    - echo testing...
    - 'dotnet test "TESTS - Multicut in Trees" /p:CollectCoverage=true /p:CoverletOutputFormat=cobertura /p:Threshold=90 /p:Exclude="[*]AutoGeneratedProgram"'
  except:
    - tags
